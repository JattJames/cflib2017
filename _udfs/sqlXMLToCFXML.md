---
layout: udf
title:  sqlXMLToCFXML
date:   2007-04-09T12:33:50.000Z
library: DataManipulationLib
argString: "doc, qry"
author: Russel Brown
authorEmail: russel.brown@universalmind.com
version: 1
cfVersion: CF6
shortDescription: Converts a query of XML generated by MSSQL to readable XML string.
tagBased: true
description: |
 Takes a query and a name for a root element and creates a XML string (not xmlObject) that can then be used within ColdFusion.  This is conversion only for MSSQL generated XML.

returnValue: Returns a string.

example: |
 <cfquery datasource="mydatasource" name="xmlQuery">
 SELECT * FROM myTable FOR XML AUTO, ELEMENTS
 </cfquery>
 
 <cfset retVar = sqlXMLToCFXML(doc="myRoot",qry=xmlQuery)/>

args:
 - name: doc
   desc: Name for root level element.
   req: true
 - name: qry
   desc: Query to convert.
   req: true


javaDoc: |
 <!---
  Converts a query of XML generated by MSSQL to readable XML string.
  
  @param doc      Name for root level element. (Required)
  @param qry      Query to convert. (Required)
  @return Returns a string. 
  @author Russel Brown (russel.brown@universalmind.com) 
  @version 1, April 9, 2007 
 --->

code: |
 <cffunction name="sqlXMLToCFXML" access="public" output="false" returntype="Any" hint="This function will take a multiple row query result and turn it into a CF XML var.">
       <cfargument name="doc" type="String" required="false" default="xml" />
       <cfargument name="qry" type="Query" required="true" />
 
       <cfset var x = "" />
       <cfset var y = "" />
       <cfset var retXML = "" />
 
       <cfset x = listFirst(arguments.qry.columnList)>
       <cfloop index="y" from="1" to="#arguments.qry.recordCount#">
          <cfset retXML = retXML & arguments.qry[x][y]>
       </cfloop>
 
       <cfset retXML = "<#arguments.doc#>" & retXML & "</#arguments.doc#>">
 
       <cfreturn retXML>
 </cffunction>

oldId: 1563
---

